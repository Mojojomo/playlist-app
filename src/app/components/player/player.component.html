<div class="player card" *ngIf="current">
  <div class="meta">
    <img *ngIf="current.cover" [src]="current.cover" alt="cover" class="cover" />
    <div class="titles">
      <h2>{{ current.title }}</h2>
      <p>{{ current.artist }}</p>
    </div>
  </div>

  <div class="timeline">
    <input
      class="range"
      type="range"
      min="0"
      max="1"
      step="0.001"
      [value]="progress"
      [style.background]="progressBackground"
      (input)="seek($event)"
    />
    <div class="time">
      <span>{{ fmt(cur) }}</span>
      <span>{{ fmt(dur) }}</span>
    </div>
  </div>

  <div class="controls">
    <button class="shuffle-btn" 
            [class.active]="isShuffled" 
            (click)="shuffle()"
            title="Shuffle Playlist">
      <lucide-icon [img]="Shuffle"></lucide-icon>
    </button>
    <button *ngIf="isShuffled" 
            class="reset-btn" 
            (click)="resetShuffle()"
            title="Reset to Original Order">
      <lucide-icon [img]="RotateCcw"></lucide-icon>
    </button>
    <button class="icon" (click)="prev()" title="Previous Track">
      <lucide-icon [img]="SkipBack"></lucide-icon>
    </button>
    <button class="icon" (click)="toggle()" title="Play/Pause">
      <lucide-icon [img]="isPlaying ? Pause : Play"></lucide-icon>
    </button>
    <button class="icon" (click)="next()" title="Next Track">
      <lucide-icon [img]="SkipForward"></lucide-icon>
    </button>
  </div>
</div>